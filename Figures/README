Codes for Figures 1-6
